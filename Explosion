using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Explosion : MonoBehaviour
{
    // ADDING VARIABLES
    public GameObject explosionParticle;
    public Rigidbody playerRb;
    public float radius = 1f;
    public float power = 30f;
    
    // ON COLLISION EVENT
    private void OnCollisionEnter(Collision collision)
    {   
        // IF THE GAMEOBJECT THAT COLLIDE WITH OUR FOR EXAMPLE EXPLOSIVE BARREL HAS TAG "Player"
        if (collision.gameObject.CompareTag("Player"))
        {
            // WE WANT TO SHOW PARTICLES FOR EXAMPLE EXPLOSION EFFECT (PARTICLES)
            GameObject explosion = Instantiate(explosionParticle, transform.position, transform.rotation);
            // CALL FUNCTION NAMED "ADDFORCE"
            AddForce();
            // DESTROY FOR EXAMPLE EXPLOSIVE BARREL AND THE PARTICLES
            Destroy(explosionParticle, 3); // THIS 3 IS TELLING THAT PARTICLES WILL BE DESTROYED AFTER 3 SECONDS
            Destroy(gameObject);

        }
    }
    // CUSTOM "AddForce" FUNCTION
    void AddForce()
    {
        // HERE WE STORE WHAT COLLIDES WITH OUR GAMEOBJECT IN THIS CASE IN BOX BUT IT CAN BE SPHERE OR WHATEVER
        Collider[] colliders = Physics.OverlapBox(transform.position, transform.localScale/2,Quaternion.identity);
        foreach(Collider col in colliders)
        { 
            // HERE WE ADD EXPLOSION FORCE WITH OUR: power(30f), transform.rotation(BASICALLY WHERE IT SHOULD EXPLODE) AND radius(1f) BASICALLY RADIUS OF EXPLOSION
            playerRb.AddExplosionForce(power, transform.position, radius);
        }
    }
}
